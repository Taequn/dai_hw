geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=6.75, sd=3.882654),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=2.266054),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.371131),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=5.15, sd=1.169045),
color="red")
(plot1|plot2)/(plot3|plot4)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=6.75, sd=3.882654/sqrt(2)),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=2.266054/sqrt(10)),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.371131/sqrt(35)),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=5.15, sd=1.169045/sqrt(50)),
color="red")
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
(plot1|plot2)/(plot3|plot4)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=6.75, sd=3.882654/sqrt(2)),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=2.266054/sqrt(10)),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.371131/sqrt(35)),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=5.15, sd=1.169045/sqrt(50)),
color="red")
(plot1|plot2)/(plot3|plot4)
var(ggdat$x1[which(ggdat$y1>0.01)])
var(ggdat$x1[which(ggdat$y2>0.01)])
var(ggdat$x1[which(ggdat$y3>0.01)])
var(ggdat$x1[which(ggdat$y4>0.01)])
var(ggdat$x1[which(ggdat$y1>0.01)])
var(ggdat$x1[which(ggdat$y2>0.01)])
var(ggdat$x1[which(ggdat$y3>0.01)])
var(ggdat$x1[which(ggdat$y4>0.01)])
var(ggdat$x1[which(ggdat$y1>0.01)])
var(ggdat$x1[which(ggdat$y2>0.01)])
var(ggdat$x1[which(ggdat$y3>0.01)])
var(ggdat$x1[which(ggdat$y4>0.01)])
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=6.75, sd=15.075/sqrt(2)),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=5.135/sqrt(10)),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.88/sqrt(35)),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=5.15, sd=1.366667/sqrt(50)),
color="red")
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
(plot1|plot2)/(plot3|plot4)
(plot1|plot2)/(plot3|plot4)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=6.75, sd=15.075/sqrt(2)),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=5.135/sqrt(10)),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.88/sqrt(35)),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=5.15, sd=1.366667/sqrt(50)),
color="red")
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=6.75, sd=3.882654),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=2.266054),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.371131),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=5.15, sd=1.169045),
color="red")
(plot1|plot2)/(plot3|plot4)
sd(ggdat$x1[which(ggdat$y1>0.01)])
sd(ggdat$x1[which(ggdat$y2>0.01)])
sd(ggdat$x1[which(ggdat$y3>0.01)])
sd(ggdat$x1[which(ggdat$y4>0.01)])
sd(ggdat$x1[which(ggdat$y1>0.01)])
sd(ggdat$x1[which(ggdat$y2>0.01)])
sd(ggdat$x1[which(ggdat$y3>0.01)])
sd(ggdat$x1[which(ggdat$y4>0.01)])
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=6.75, sd=3.882654/sqrt(2)),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=2.266054/sqrt(10)),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.371131/sqrt(35)),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=5.15, sd=1.169045/sqrt(50)),
color="red")
(plot1|plot2)/(plot3|plot4)
sqrt(var(ggdat$x1[which(ggdat$y1>0.01)]))
sqrt(var(ggdat$x1[which(ggdat$y2>0.01)]))
sqrt(ggdat$x1[which(ggdat$y3>0.01)]))
sqrt((ggdat$x1[which(ggdat$y4>0.01)]))
sqrt(var(ggdat$x1[which(ggdat$y1>0.01)]))
sqrt(var(ggdat$x1[which(ggdat$y2>0.01)]))
sqrt(ggdat$x1[which(ggdat$y3>0.01)]))
sqrt(ggdat$x1[which(ggdat$y3>0.01)])
sqrt(var(ggdat$x1[which(ggdat$y1>0.01)]))
sqrt(var(ggdat$x1[which(ggdat$y2>0.01)]))
sqrt(var(ggdat$x1[which(ggdat$y3>0.01)]))
sqrt(var(ggdat$x1[which(ggdat$y4>0.01)]))
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
(plot1|plot2)/(plot3|plot4)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=6.75, sd=3.882654),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=2.266054),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.371131),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=5.15, sd=1.169045),
color="red")
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/2*0.2)^2)),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=5.55, sd=2.266054),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=5.2, sd=1.371131),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=50*(1/(50*0.2)), sd=sqrt(50*(1/(50*0.2))^2)),
color="red")
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/2*0.2)^2)),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=10*(1/(10*0.2)), sd=sqrt(10*(1/(10*0.2)^2))),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=35*(1/(35*0.2)), sd=sqrt(35*(1/(35*0.2)^2))),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=50*(1/(50*0.2)), sd=sqrt(50*(1/(50*0.2))^2)),
color="red")
(plot1|plot2)/(plot3|plot4)
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(10*0.2)), sd=sqrt(2*(1/(2*0.2)^2))),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=10*(1/(10*0.2)), sd=sqrt(10*(1/(10*0.2)^2))),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=35*(1/(35*0.2)), sd=sqrt(35*(1/(35*0.2)^2))),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=50*(1/(50*0.2)), sd=sqrt(50*(1/(50*0.2))^2)),
color="red")
(plot1|plot2)/(plot3|plot4)
?dnorm
1-pnorm(1, mean=2*(1/(10*0.2)), sd=sqrt(2*(1/(2*0.2)^2)))
1-pnorm(1, mean=2*(1/(10*0.2)), sd=sqrt(2*(1/(2*0.2)^2)))-(1-pnorm(3, mean=2*(1/(10*0.2)), sd=sqrt(2*(1/(2*0.2)^2))))
?t.test
library("quantreg")
data("uis")
mean(uis$LEN.T)
res <- t.test(uis$LEN.T ~ uis$SITE,
mu = 100.7565,
data = uis, var.equal = TRUE)
res
res <- t.test(x=uis$LEN.T, y=uis$SITE,
mu = 100.7565,
data = uis, var.equal = TRUE)
res
res <- t.test(uis$LEN.T ~ uis$SITE,
mu = 100.7565,
data = uis, var.equal = TRUE)
res
res <- t.test(uis$LEN.T ~ uis$SITE,
data = uis, var.equal = TRUE)
res
res <- t.test(uis$LEN.T ~ uis$SITE,
data = uis, var.equal = F)
res
# Let's Visualize It
library(tidyverse)
ggdat<-data.frame(x=seq(-4,4,length.out=500))%>%
mutate(f=dnorm(x))
ggplot(data=ggdat, aes(x=x,y=f))+
geom_line()+
geom_hline(yintercept=0)+
geom_point(aes(x=-sqrt(0.29549), y=0), color="red")+
# shade the RR
geom_ribbon(data=subset(ggdat, x<=qnorm(p=alpha, mean=0, sd=1)),
aes(ymin=0, ymax=f),
fill="grey")+
geom_vline(xintercept=qnorm(p=alpha, mean=0, sd=1),
linetype="dashed", color="red")+
# shade the p-value
geom_ribbon(data=subset(ggdat, x<(-sqrt(0.29549))),
aes(ymin=0, ymax=f),
fill="red", alpha=0.25)+
# annotate plot with key values
annotate("text", x=-.5, y=0.02,
size=3,
label="Observation")+
annotate("text", x=-2, y=0.02,
label=deparse(bquote(alpha/2)),
size=3,
parse=TRUE)+
annotate("text", x=-3, y=0.15,
label="p-value = 0.2934",
size=3)+
annotate("text", x=-1.9, y=0.3,
label="Rejection Region",
size=3, angle=90,
color="red")+
theme_bw()+
xlab("Z")+
ylab("Density")+
ggtitle("Hypothesis Test For the Population Proportion",
subtitle=bquote(H[0]:p==0.33~"vs"~H[a]:p<0.33))
x <- 8 # lead past limit
n <- 30
#####################################################
#####################################################
# Confidence Intervals
#####################################################
#####################################################
library(binom)
binom.confint(x=x, n=n)
# wilson (default) assumptions satisfied: n>5
# agresti-coull assumptions satisfied: n \geq 10
# wald (asymptotic) assumptions NOT satisfied:
#       8 events of interest      < 15
#      22 not events of interest  > 15
# Remark: calling the event of interest a success here
#         would be calling a water sample with high
#         levels of lead a ``success." Yikes!
#####################################################
#####################################################
# Hypothesis Test
#####################################################
#####################################################
# CLT: X1, X2, ... X_n ~ Bernoulli(p)
# p.hat ~ AG(p, sqrt(p*(1-p))/sqrt(n))
# Centering and scaling
# Z = (p.hat-p)/sqrt(p*(1-p)/n) ~ AG(0,1)
# H0: p=0.33  (assumption)
# Ha: p<0.33  (want to show)
prop.test(x=8, n=30,
p = 0.33, alternative="less")
# We fail to reject the null hypothesis.
# We do not have significant evidence that the proportion
# of homes with high lead measurements is less than .33
# (z=-0.5436, p=0.2934).
#Remark: The code gives us chi^2.
#        Z = +/- sqrt(chi^2)
# we take the negative root above because our observation (.2667)
# is smaller than the hypothesized value (0.33), thus p.hat-p < 0
# Rejection Region
# We are interested in observations that are so small they
# suggest the true population proportion is smaller than
# 0.33. We take this to be the lower 0.05 (5%) of the sampling
# distribution
alpha <- 0.05
qnorm(p=0.05, mean=0, sd=1)
# We reject for observations yielding z<=-1.644854
# Let's Visualize It
library(tidyverse)
ggdat<-data.frame(x=seq(-4,4,length.out=500))%>%
mutate(f=dnorm(x))
ggplot(data=ggdat, aes(x=x,y=f))+
geom_line()+
geom_hline(yintercept=0)+
geom_point(aes(x=-sqrt(0.29549), y=0), color="red")+
# shade the RR
geom_ribbon(data=subset(ggdat, x<=qnorm(p=alpha, mean=0, sd=1)),
aes(ymin=0, ymax=f),
fill="grey")+
geom_vline(xintercept=qnorm(p=alpha, mean=0, sd=1),
linetype="dashed", color="red")+
# shade the p-value
geom_ribbon(data=subset(ggdat, x<(-sqrt(0.29549))),
aes(ymin=0, ymax=f),
fill="red", alpha=0.25)+
# annotate plot with key values
annotate("text", x=-.5, y=0.02,
size=3,
label="Observation")+
annotate("text", x=-2, y=0.02,
label=deparse(bquote(alpha/2)),
size=3,
parse=TRUE)+
annotate("text", x=-3, y=0.15,
label="p-value = 0.2934",
size=3)+
annotate("text", x=-1.9, y=0.3,
label="Rejection Region",
size=3, angle=90,
color="red")+
theme_bw()+
xlab("Z")+
ylab("Density")+
ggtitle("Hypothesis Test For the Population Proportion",
subtitle=bquote(H[0]:p==0.33~"vs"~H[a]:p<0.33))
library("boot")
data("nodal")
head(nodal)
nodal.c <- nodal %>%
mutate(sev = case_when(stage==1 ~ 1,
grade==1 ~ 1,
xray==1 ~ 1,
TRUE ~ 0))
view(nodal.c)
table(nodal.c)
head(nodal.c)
table(nodal.c$sev)
prop.table(table(nodal.c$sev, nodal.c$r))
prop.table(table(nodal.c$sev), nodal.c$r)
prop.table(table(nodal.c$sev, nodal.c$r))
?prop.table
prop.table(table(nodal.c$sev, nodal.c$r),
margin=1)
prop.table(table(nodal.c$sev, nodal.c$r),
margin=2)
prop.test(nodal$r)
table(nodal$r)
prop.test(20, 53)
sqrt(2.717)
p0 <- 0.5
phat <- table(nodal$r)[2]/nrow(nodal)
n <- nrow(nodal)
z1 <- qt(.975, n-1)
z2 <- -z1
(sqrt(n)*z1*sqrt(p0*(1-p0)))/(n) + p0 #for upper bound
(sqrt(n)*z2*sqrt(p0*(1-p0)))/(n) + p0 #for lower bound
sqrt(2.717)
z2 <- -z1
z1 <- qt(.975, n-1)
prop.test(20, 53)
table(nodal$r)
prop.test(20, 53)
prop.test(20, 53, alternative="less")
prop.table(table(nodal.c$sev, nodal.c$r),
margin=2)
?prop.test
nodal.c <- nodal %>%
mutate(sev = case_when(stage==1 ~ 1,
grade==1 ~ 1,
xray==1 ~ 1,
TRUE ~ 0))%>%
group_by(sev)
(nodal.c)
nodal.c <- nodal %>%
mutate(sev = case_when(stage==1 ~ 1,
grade==1 ~ 1,
xray==1 ~ 1,
TRUE ~ 0))%>%
group_by(sev)%>%
summarise(total = n())
(nodal.c)
prop.test(37, 53,
alternative = "two.sided")
prop.test(37, 53,
alternative = "two.sided")
prop.test(37, 53,
p=0.5,
alternative = "two.sided")
(nodal.c)
#H0: phat = 0.5
#Ha: phat != 0.5
nodal.c <- nodal %>%
mutate(sev = case_when(stage==1 ~ 1,
grade==1 ~ 1,
xray==1 ~ 1,
TRUE ~ 0))%>%
group_by(sev, r)%>%
summarise(total = n())
(nodal.c)
prop.test(19, 53,
p=0.5,
alternative = "two.sided")
prop.test(19, 20,
p=0.5,
alternative = "two.sided")
(nodal.c)
