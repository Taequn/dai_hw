title="Gamma distribution for n = 50",
subtitle=paste("Alpha = 50", "Beta =",1/(50*0.2)))
(plot1|plot2)/(plot3|plot4)
#You would ask me:
#Chris, but why do you limit your x from 0 to 30.
#And I would tell you:
#Because it's cool!
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle=paste("Alpha = 2", "Beta =",1/(2*0.2)))
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 10",
subtitle=paste("Alpha = 10", "Beta =",1/(10*0.2)))
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)+
labs(y="Density",
title="Gamma distribution for n = 35",
subtitle=paste("Alpha = 35", "Beta =",1/(35*0.2)))
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)+
labs(y="Density",
title="Gamma distribution for n = 50",
subtitle=paste("Alpha = 50", "Beta =",1/(50*0.2)))
(plot1|plot2)/(plot3|plot4)
1/(2*0.2)
1/(10*0.2)
1/(35*0.2)
1/(50*0.2)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 10",
subtitle="Alpha = 10, Beta = 0.5")
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)+
labs(y="Density",
title="Gamma distribution for n = 35",
subtitle="Alpha = 35, Beta = 0.1428")
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)+
labs(y="Density",
title="Gamma distribution for n = 50",
subtitle="Alpha = 50, Beta = 0.1")
(plot1|plot2)/(plot3|plot4)
library(patchwork)
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line()+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line()+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 10",
subtitle="Alpha = 10, Beta = 0.5")
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line()+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 35",
subtitle="Alpha = 35, Beta = 0.14")
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line()+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 50",
subtitle="Alpha = 50, Beta = 0.1")
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line(color="green")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line(color="red")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 10",
subtitle="Alpha = 10, Beta = 0.5")
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line(color="blue")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 35",
subtitle="Alpha = 35, Beta = 0.14")
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line(color="pink")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 50",
subtitle="Alpha = 50, Beta = 0.1")
(plot1|plot2)/(plot3|plot4)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line(color="yellow")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 50",
subtitle="Alpha = 50, Beta = 0.1")
(plot1|plot2)/(plot3|plot4)
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line(color="black")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 50",
subtitle="Alpha = 50, Beta = 0.1")
(plot1|plot2)/(plot3|plot4)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/(2*0.2)^2))),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=10*(1/(10*0.2)), sd=sqrt(10*(1/(10*0.2)^2))),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=35*(1/(35*0.2)), sd=sqrt(35*(1/(35*0.2)^2))),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=50*(1/(50*0.2)), sd=sqrt(50*(1/(50*0.2))^2)),
color="red")
(plot1|plot2)/(plot3|plot4)
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line(color="green")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line(color="dark red")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 10",
subtitle="Alpha = 10, Beta = 0.5")
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line(color="blue")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 35",
subtitle="Alpha = 35, Beta = 0.14")
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line(color="black")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 50",
subtitle="Alpha = 50, Beta = 0.1")
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/(2*0.2)^2))),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=10*(1/(10*0.2)), sd=sqrt(10*(1/(10*0.2)^2))),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=35*(1/(35*0.2)), sd=sqrt(35*(1/(35*0.2)^2))),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=50*(1/(50*0.2)), sd=sqrt(50*(1/(50*0.2))^2)),
color="red")
(plot1|plot2)/(plot3|plot4)
values=c(myline1="green", myline2="blue")
(plot1|plot2)/(plot3|plot4)
#You would ask me:
#Chris, but why do you limit your x from 0 to 30.
#And I would tell you:
#Because it's cool!
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line(color="green")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/(2*0.2)^2))),
color="red")+
scale_colour_manual(name="Line Color",
values=c(myline1="green", myline2="blue"))
(plot1|plot2)/(plot3|plot4)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/(2*0.2)^2))),
color="red")+
scale_colour_manual(name="Line Color",
values=c(myline1="green", myline2="red"))
#You would ask me:
#Chris, but why do you limit your x from 0 to 30.
#And I would tell you:
#Because it's cool!
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line(color="green")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/(2*0.2)^2))),
color="red")+
scale_colour_manual(name="Line Color",
values=c(myline1="green", myline2="red"))
plot1
#You would ask me:
#Chris, but why do you limit your x from 0 to 30.
#And I would tell you:
#Because it's cool!
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line(color="myline1")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/(2*0.2)^2))),
color="myline2")+
scale_colour_manual(name="Line Color",
values=c(myline1="green", myline2="red"))
plot1
#You would ask me:
#Chris, but why do you limit your x from 0 to 30.
#And I would tell you:
#Because it's cool!
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line(color="colour")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")+
scale_colour_manual(name="Line Color",
values=c(myline1="red"))
plot1
plot1<-ggplot(ggdat, aes(x=x, y=y1))+
geom_line(color="green")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 2",
subtitle="Alpha = 2, Beta = 2.5")
plot2<-ggplot(ggdat, aes(x=x, y=y2))+
geom_line(color="dark red")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 10",
subtitle="Alpha = 10, Beta = 0.5")
plot3<-ggplot(ggdat, aes(x=x, y=y3))+
geom_line(color="blue")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 35",
subtitle="Alpha = 35, Beta = 0.14")
plot4<-ggplot(ggdat, aes(x=x, y=y4))+
geom_line(color="black")+
xlim(0,30)+
theme_bw()+
labs(y="Density",
title="Gamma distribution for n = 50",
subtitle="Alpha = 50, Beta = 0.1")
(plot1|plot2)/(plot3|plot4)
plot1 <- plot1+
geom_function(fun=dnorm, args=list(mean=2*(1/(2*0.2)), sd=sqrt(2*(1/(2*0.2)^2))),
color="red")
plot2 <- plot2+
geom_function(fun=dnorm, args=list(mean=10*(1/(10*0.2)), sd=sqrt(10*(1/(10*0.2)^2))),
color="red")
plot3 <- plot3+
geom_function(fun=dnorm, args=list(mean=35*(1/(35*0.2)), sd=sqrt(35*(1/(35*0.2)^2))),
color="red")
plot4 <- plot4+
geom_function(fun=dnorm, args=list(mean=50*(1/(50*0.2)), sd=sqrt(50*(1/(50*0.2))^2)),
color="red")
(plot1|plot2)/(plot3|plot4)
n=nrow(uis)
tstat <- t.test(x=uis$BECK,
mu = 13,
alternative = "greater")
paste("P-value:", tstat$p.value)
ggdat <- data.frame(t=seq(-5,5,length=500))%>%
mutate(f=dt(x=t, df=n-1))
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=tstat$statistic, y=0), color="red")+
geom_vline(xintercept=qt(p=0.95, df=n-1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qt(p=0.95, df=n-1), y=0.30,
label="Rejection Region", angle="270",
color="red")+
annotate("text", x=tstat$statistic-1.8, y=0.02,
label="P-value = 7.41 * 10^-27",
size=3)
qt(p=0.95, df=n-1)
(value<-(qt(.95, n-1)*se)+mu0)
n<-nrow(uis)
se = sd(uis$BECK)/sqrt(n)
(value<-(qt(.95, n-1)*se)+mu0)
(value<-(qt(.95, n-1)*se)+mu0)
mu <- mean(uis$BECK)
mu0 <- 13
paste("The mean of BECK is", mean(mu))
(value<-(qt(.95, n-1)*se)+mu0)
tstat <- t.test(x=uis$BECK,
mu = 13,
alternative = "greater")
tstat
qt(p=0.95, df=n-1)
qt(p=0.95, df=574)
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=tstat$statistic, y=0), color="red")+
geom_vline(xintercept=qt(p=0.95, df=n-1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qt(p=0.95, df=n-1), y=0.30,
label="Rejection Region", angle="270",
color="red")+
annotate("text", x=tstat$statistic-1.8, y=0.02,
label="P-value = 7.41 * 10^-27",
size=3)
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=tstat$statistic, y=0), color="red")+
geom_vline(xintercept=qt(p=0.95, df=n-1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qt(p=0.95, df=n-1), y=0.30,
label="Rejection Region", angle="270",
color="red")+
annotate("text", x=tstat$statistic-1.8, y=0.02,
label="P-value = 7.41 * 10^-27",
size=3)+
theme_bw()
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=tstat$statistic, y=0), color="red")+
geom_vline(xintercept=qt(p=0.95, df=n-1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qt(p=0.95, df=n-1), y=0.30,
label="Rejection Region", angle="270",
color="red")+
annotate("text", x=tstat$statistic-1.8, y=0.02,
label="P-value = 7.41 * 10^-27",
size=3)+
theme_bw()+
labs(x="T",
y="Density",
title="T-distribution to assess a null hypothesis")
res <- t.test(uis$LEN.T ~ uis$SITE,
data = uis, var.equal = F)
res
paste("P-value:"res$p.value)
paste("P-value:",res$p.value)
prop.test(20, 53, alternative="less")
z1 <- qt(.05, n-1)
(sqrt(n)*z1*sqrt(p0*(1-p0)))/(n) + p0 #for upper bound
z1 <- qnorm(.05, 0, 1)
(sqrt(n)*z1*sqrt(p0*(1-p0)))/(n) + p0 #for upper bound
table(nodal$r)
ggdat <- data.frame(t=seq(-5,5,length=500))%>%
mutate(f=dnorm(x=t, mean=0, sd=1))
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=zAns, y=0), color="red")+
geom_vline(xintercept=qnorm(p=0.05, mean=0, sd=1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qnorm(p=0.05, mean=0, sd=1), y=0.30,
label="Rejection Region", angle="90",
color="red")+
annotate("text", zAns+1.1, y=0.01,
label="p-value = 0.04964",
size=3)
answerProp<-(sqrt(n)*z1*sqrt(p0*(1-p0)))/(n) + p0
paste("Rejection starts with", answerProp, "but we already have a lower number:",
table(nodal$r)[2]/nrow(nodal))
zAns <- (phat-p0)/sqrt((p0*(1-p0))/(n))
zAns
table(nodal$r)[2]/nrow(nodal)
table(nodal)
table(nodal$r)
prop.test(20, 33, alternative="lesser")
prop.test(20, 33, alternative="less")
prop.test(20, 33, mu=0.5 alternative="less")
prop.test(20, 33, mu=0.5, alternative="less")
prop.test(20, 33, p=0.5, alternative="less")
prop.test(20, 53, p=0.5, alternative="less")
table(nodal$r)
answerPropTest <- prop.test(20, 53, p=0.5, alternative="less")
paste("P-value:",answerPropTest$p.value)
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=zAns, y=0), color="red")+
geom_vline(xintercept=qnorm(p=0.05, mean=0, sd=1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qnorm(p=0.05, mean=0, sd=1), y=0.30,
label="Rejection Region", angle="90",
color="red")+
annotate("text", zAns+1.1, y=0.01,
label="p-value = 0.04964",
size=3)+
theme_bw()
sqrt(answerPropTest$statistic)
-sqrt(answerPropTest$statistic)
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=-sqrt(answerPropTest$statistic), y=0), color="red")+
geom_vline(xintercept=qnorm(p=0.05, mean=0, sd=1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qnorm(p=0.05, mean=0, sd=1), y=0.30,
label="Rejection Region", angle="90",
color="red")+
annotate("text", zAns+1.1, y=0.01,
label="p-value = 0.04964",
size=3)+
theme_bw()
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=-sqrt(answerPropTest$statistic), y=0), color="red")+
geom_vline(xintercept=qnorm(p=0.05, mean=0, sd=1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qnorm(p=0.05, mean=0, sd=1), y=0.30,
label="Rejection Region", angle="90",
color="red")+
annotate("text", -sqrt(answerPropTest$statistic), y=0.01,
label="p-value = 0.04964",
size=3)+
theme_bw()
propCI<-prop.test(20, 53, alternative="two.sided")
propCI$conf.int
paste("Confidence interval is", propCI$conf.int)
#H0: p1-p2 = 0
#Ha: p1-p2 != 0
nodal.c <- nodal %>%
mutate(sev = case_when(stage==1 ~ 1,
grade==1 ~ 1,
xray==1 ~ 1,
TRUE ~ 0))
#H0: p1-p2 = 0
#Ha: p1-p2 != 0
nodal.c <- nodal %>%
mutate(sev = case_when(stage==1 ~ 1,
grade==1 ~ 1,
xray==1 ~ 1,
TRUE ~ 0))
#non severe
x1<-1
n1<-16
#severe
x2<-19
n2<-37
prop.test(x=c(x1,x2),
n=c(n1,n2))
finalProp <- prop.test(x=c(x1,x2),
n=c(n1,n2))
paste("P-value of two-sample test is ", finalProp$p.value)
ggplot(data=ggdat, aes(x=t, y=f))+
geom_line() +
geom_hline(yintercept=0)+
geom_point(aes(x=tstat$statistic, y=0), color="red")+
geom_vline(xintercept=qt(p=0.95, df=n-1),
linetype="dashed", color="red")+
annotate("text", x=1.2*qt(p=0.95, df=n-1), y=0.30,
label="Rejection Region", angle="270",
color="red")+
annotate("text", x=tstat$statistic-1.8, y=0.02,
label="P-value = 7.41 * 10^-27",
size=3)+
theme_bw()+
labs(x="T",
y="Density",
title="T-distribution to assess a null hypothesis")
